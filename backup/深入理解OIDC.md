> 以下内容来源腾讯云开发社区 [点击查看](https://cloud.tencent.com/developer/article/2416477)
# 关于OIDC，一种现代身份验证协议
在数字化时代。随着网络服务的普及和应用生态的日益复杂，**用户验证**与**授权机制**成为了保障网络安全与隐私的关键。 OpenId Connect（OIDC）作为一种基于OAuth2.0协议的开放标准，为实现安全、便捷的在线身份认证提供了一套全面的解决方案。本文将深入探讨OIDC的核心概念、工作流程、优势以及引用场景，帮助读者全面理解这一现代身份验证协议。

## 一、OIDC概述
OpenID Connect（OIDC）是由OpenID基金会开发的一种身份层协议，它建立在OAuth2.0框架之上，旨在提供一种标准化的方式来验证用户身份并获取其级别信息。与单纯的OAuth2.0不同，OIDC不仅关注授权，更强调身份验——确认“你是谁”。

OpenID Connect（OIDC）和OAuth2.0是两个密切相关但功能定位不同的协议，它们在现代网络应用的认证和授权体系统扮演着关键角色。下面是它们之间的一些主要区别：
1. 目标与功能
- OAuth2.0主要是一个授权框架，它允许用户授权第三方应用访问其存储在另一服务商（资源服务器）上的资源，而不必共享用户名和和密码。OAuth2.0关注授权（access），即决定一个应用是否有权限访问特定的资源，但并不直接处理用户身份的验证。
- OpenID Connect（OIDC）则是在OAuth2.0的基础上发展起来的一个身份认证协议。它在提供授权的同时，也提供了一种标准化的方式去验证终端用户的身份。OIDC引入了ID Token的概念，这是一种包含用户身份信息的JWT，使得应用可以确信“谁”正在访问，而不仅仅是可以访问什么。
2. 认证和授权
- OAuth2.0仅处理授权问题，即“应用A是否能访问用户B在服务C上的资源”，但它不直接处理用户身份的认证。
- OIDC则及处理授权也处理认证，它确保应用不仅可以获取访问权限，还能确认用户的真实身份。
3. 信息交换
- OAuth2.0使用访问令牌（Access Tokens）来代表用户授权给应用的权限，但这些令牌不包括用户身份信息。
- OIDC在OAuth2.0的流程中加入了ID Tokens，这是一种包含用户身份信息的安全令牌，可以在验证用户身份的同时，传递一些基本的用户属性。
4. 安全性
- OAuth2.0提供了安全的授权机制，但是关于用户和身份验证的部分需要额外的机制来补充。
- OIDC内置了更强的安全措施，比如使用JWT和加密技术保护ID Token， 确保了身份信息在传输过程中的安全性和完整性。
5. 应用场景
- OAuth2.0常见于第三方应用需要访问用户数据的场景，如社交媒体登录、云服务api访问等、
- OIDC更适用于需要确认用户真实身份的服务，如企业的单点登录，金融服务的身份验证等。
尽管OIDC基于OAuth2.0构建，但它通过添加身份认证层，提供了更全面的解决方案，以适应现代互联网应用中对用户身份和授权的需求。

## 二、核心组件
1. **身份提供商（Identity Provider IdP）**： 负责验证用户身份并颁发身份令牌的实体。
2. **第三方应用（Relying Party，RP）**： 需要验证用户身份的应用或服务。
3. **用户代理（User Agent，UA）**： 用户的浏览器或其他客户端软件，用于与IdP和RP交互交互
4. **授权码（Authorization Code）**： 在OAuth2.0流程中，IdP向RP发送一个临时代码，RP使用该代码交换访问令牌。
5. **ID令牌（ID Token）**: OIDC特有的概念，是一个JWT，包含了用户的级别信息，用于直接验证用户身份信息。

## 三、OIDC工作流程
OIDC的工作流程大概可以分为以下步骤：
1. 用户请求访问RP: 用户尝试访问依赖方（RP）提供的受保护资源。
2. 重定向至IdP: RP讲用户重定向到预先配置的身份提供商品（IdP）进行登录。
3. 用户身份验证： 用户在IdP上输入凭证完成身份验证。
4. 授权码发放：IdP向用户代理返回一个授权码，并附带RP的重定向URI。
5. RP交换令牌： RP通过后端服务器向IdP发送授权码，请求换取访问令牌和ID令牌。
6. 验证ID令牌： RP验证ID令牌的有效性（签名、过期时间等），并提取用户信息。
7. 访问资源： 验证成功后，RP允许用户访问受保护资源。
